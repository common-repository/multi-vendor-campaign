jQuery(document).ready(function(c){c(".products-input-search").on("keypress",function(){var a=c(this),i=a.siblings(".product-search-result"),s=a.parents(".products-input-container"),n=a.parents(".campaign-item").find(".selected-items");2<=this.value.length&&(s.addClass("searching"),a={action:"search_products_by_title",security:rad_mvc_object.security,title:this.value,campaign_id:a.data("campaignid")},c.ajax({data:a,type:"POST",url:rad_mvc_object.ajaxurl,dataType:"json",success:function(a){var e,t="";for(e in a)n.find('li[data-productid="'+e+'"]').length<=0&&(t+=a[e].item);s.removeClass("searching"),i.empty().append(c(t))}}))}),c(document).on("click",".product-search-result li.newitem",function(){var a=c(this);a.parents(".campaign-item").find(".selected-items").append(a),a.parents(".campaign-item").find(".button_subscribe_campaign").removeClass("disable")}),c(document).on("click",".selected-items li .remove",function(){var a,e=c(this);e.parents("li").hasClass("newitem")?e.parents("li").remove():(e.siblings(".status").removeClass("pending").addClass("isloading"),a={action:"unsubscribe_product",security:rad_mvc_object.security,product_id:e.parents("li").data("productid"),campaign_id:e.parents(".campaign-item").data("campaignid")},c.ajax({data:a,type:"POST",url:rad_mvc_object.ajaxurl,dataType:"json",success:function(a){1==a?e.parents("li").remove():e.siblings(".status").removeClass("isloading").addClass("pending")}}))}),c(".button_subscribe_campaign").on("click",function(){var t=c(this),i=t.parents(".campaign-item").find(".selected-items li.newitem"),a=i.map(function(){return c(this).data("productid")}).get();t.hasClass("disable")||a.length<=0||(t.addClass("showloading"),a={action:"subscribe_products_to_campaign",security:rad_mvc_object.security,campaign_id:t.data("campaignid"),product_ids:a.join(",")},c.ajax({data:a,type:"POST",url:rad_mvc_object.ajaxurl,dataType:"json",success:function(a){for(var e in t.siblings("loading").removeClass("show"),a)0<i.filter('li[data-productid="'+e+'"]').length&&a[e]&&i.filter('li[data-productid="'+e+'"]').removeClass("newitem");t.addClass("disable")},complete:function(){t.removeClass("showloading")}}))})});